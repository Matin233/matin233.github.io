(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{435:function(t,e,a){"use strict";a.r(e);var n=a(44),r=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"共享代码-behavior"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#共享代码-behavior"}},[t._v("#")]),t._v(" 共享代码 (Behavior)")]),t._v(" "),a("p",[a("code",[t._v("behaviors")]),t._v(" 是用于组件间代码共享的特性，类似于一些编程语言中的 “mixins” 或 “traits”。")]),t._v(" "),a("p",[t._v("每个 "),a("code",[t._v("behavior")]),t._v(" 可以包含一组属性、数据、生命周期函数和方法。"),a("strong",[t._v("组件引用它时，它的属性、数据和方法会被合并到组件中，生命周期函数也会在对应时机被调用。")]),t._v(" 每个组件可以引用多个 "),a("code",[t._v("behavior")]),t._v(" ，"),a("code",[t._v("behavior")]),t._v(" 也可以引用其它 "),a("code",[t._v("behavior")]),t._v(" 。")]),t._v(" "),a("p",[t._v("详细的参数含义和使用请参考 "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/reference/api/Behavior.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Behavior 参考文档"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"组件中使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件中使用"}},[t._v("#")]),t._v(" 组件中使用")]),t._v(" "),a("p",[t._v("组件引用时，在 "),a("code",[t._v("behaviors")]),t._v(" 定义段中将它们逐个列出即可。")]),t._v(" "),a("p",[a("strong",[t._v("代码示例：")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://developers.weixin.qq.com/s/Yq4RqCm87thO",target:"_blank",rel:"noopener noreferrer"}},[t._v("在开发者工具中预览效果"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// my-component.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" myBehavior "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-behavior'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  behaviors"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("myBehavior"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  properties"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    myProperty"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    myData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-component-data'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("created")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[my-component] created'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("attached")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[my-component] attached'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("ready")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[my-component] ready'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("myMethod")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[my-component] log by myMethod'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("在上例中， "),a("code",[t._v("my-component")]),t._v(" 组件定义中加入了 "),a("code",[t._v("my-behavior")]),t._v("，")]),t._v(" "),a("p",[t._v("而 "),a("code",[t._v("my-behavior")]),t._v(" 结构为：")]),t._v(" "),a("ul",[a("li",[t._v("属性："),a("code",[t._v("myBehaviorProperty")])]),t._v(" "),a("li",[t._v("数据字段："),a("code",[t._v("myBehaviorData")])]),t._v(" "),a("li",[t._v("方法："),a("code",[t._v("myBehaviorMethod")])]),t._v(" "),a("li",[t._v("生命周期函数："),a("code",[t._v("attached")]),t._v("、"),a("code",[t._v("created")]),t._v("、"),a("code",[t._v("ready")])])]),t._v(" "),a("p",[t._v("这将使 "),a("code",[t._v("my-component")]),t._v(" 最终结构为：")]),t._v(" "),a("ul",[a("li",[t._v("属性："),a("code",[t._v("myBehaviorProperty")]),t._v("、"),a("code",[t._v("myProperty")])]),t._v(" "),a("li",[t._v("数据字段："),a("code",[t._v("myBehaviorData")]),t._v("、"),a("code",[t._v("myData")])]),t._v(" "),a("li",[t._v("方法："),a("code",[t._v("myBehaviorMethod")]),t._v("、"),a("code",[t._v("myMethod")])]),t._v(" "),a("li",[t._v("生命周期函数："),a("code",[t._v("attached")]),t._v("、"),a("code",[t._v("created")]),t._v("、"),a("code",[t._v("ready")])])]),t._v(" "),a("p",[t._v("当组件触发生命周期时，上例生命周期函数执行顺序为：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("[my-behavior] created")])]),t._v(" "),a("li",[a("code",[t._v("[my-component] created")])]),t._v(" "),a("li",[a("code",[t._v("[my-behavior] attached")])]),t._v(" "),a("li",[a("code",[t._v("[my-component] attached")])]),t._v(" "),a("li",[a("code",[t._v("[my-behavior] ready")])]),t._v(" "),a("li",[a("code",[t._v("[my-component] ready")])])]),t._v(" "),a("p",[t._v("详细规则参考 "),a("strong",[t._v("同名字段的覆盖和组合规则")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"同名字段的覆盖和组合规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同名字段的覆盖和组合规则"}},[t._v("#")]),t._v(" 同名字段的覆盖和组合规则")]),t._v(" "),a("p",[t._v("组件和它引用的 "),a("code",[t._v("behavior")]),t._v(" 中可以包含同名的字段，对这些字段的处理方法如下：")]),t._v(" "),a("ul",[a("li",[t._v("如果有同名的属性 (properties) 或方法 (methods)：\n"),a("ol",[a("li",[t._v("若组件本身有这个属性或方法，则组件的属性或方法会覆盖 "),a("code",[t._v("behavior")]),t._v(" 中的同名属性或方法；")]),t._v(" "),a("li",[t._v("若组件本身无这个属性或方法，则在组件的 "),a("code",[t._v("behaviors")]),t._v(" 字段中定义靠后的 "),a("code",[t._v("behavior")]),t._v(" 的属性或方法会覆盖靠前的同名属性或方法；")]),t._v(" "),a("li",[t._v("在 2 的基础上，若存在嵌套引用 "),a("code",[t._v("behavior")]),t._v(" 的情况，则规则为："),a("code",[t._v("父 behavior")]),t._v(" 覆盖 "),a("code",[t._v("子 behavior")]),t._v(" 中的同名属性或方法。")])])]),t._v(" "),a("li",[t._v("如果有同名的数据字段 (data)：\n"),a("ul",[a("li",[t._v("若同名的数据字段都是对象类型，会进行对象合并；")]),t._v(" "),a("li",[t._v("其余情况会进行数据覆盖，覆盖规则为：组件 > "),a("code",[t._v("父 behavior")]),t._v(" > "),a("code",[t._v("子 behavior")]),t._v(" 、 "),a("code",[t._v("靠后的 behavior")]),t._v(" > "),a("code",[t._v("靠前的 behavior")]),t._v("。（优先级高的覆盖优先级低的，最大的为优先级最高）")])])]),t._v(" "),a("li",[t._v("生命周期函数不会相互覆盖，而是在对应触发时机被逐个调用：\n"),a("ul",[a("li",[t._v("对于不同的生命周期函数之间，遵循组件生命周期函数的执行顺序；")]),t._v(" "),a("li",[t._v("对于同种生命周期函数，遵循如下规则：\n"),a("ul",[a("li",[a("code",[t._v("behavior")]),t._v(" 优先于组件执行；")]),t._v(" "),a("li",[a("code",[t._v("子 behavior")]),t._v(" 优先于 "),a("code",[t._v("父 behavior")]),t._v(" 执行；")]),t._v(" "),a("li",[a("code",[t._v("靠前的 behavior")]),t._v(" 优先于 "),a("code",[t._v("靠后的 behavior")]),t._v(" 执行；")])])]),t._v(" "),a("li",[t._v("如果同一个 "),a("code",[t._v("behavior")]),t._v(" 被一个组件多次引用，它定义的生命周期函数只会被执行一次。")])])])]),t._v(" "),a("p",[a("strong",[t._v("代码示例：")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://developers.weixin.qq.com/s/CI5omDmT7khB",target:"_blank",rel:"noopener noreferrer"}},[t._v("在开发者工具中预览效果"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"内置-behaviors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内置-behaviors"}},[t._v("#")]),t._v(" 内置 behaviors")]),t._v(" "),a("p",[t._v("自定义组件可以通过引用内置的 "),a("code",[t._v("behavior")]),t._v(" 来获得内置组件的一些行为。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  behaviors"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wx://form-field'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("在上例中， "),a("code",[t._v("wx://form-field")]),t._v(" 代表一个内置 "),a("code",[t._v("behavior")]),t._v(" ，它使得这个自定义组件有类似于表单控件的行为。")]),t._v(" "),a("p",[t._v("内置 "),a("code",[t._v("behavior")]),t._v(" 往往会为组件添加一些属性。在没有特殊说明时，组件可以覆盖这些属性来改变它的 "),a("code",[t._v("type")]),t._v(" 或添加 "),a("code",[t._v("observer")]),t._v(" 。")]),t._v(" "),a("h3",{attrs:{id:"wx-form-field"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wx-form-field"}},[t._v("#")]),t._v(" wx://form-field")]),t._v(" "),a("p",[t._v("使自定义组件有类似于表单控件的行为。 form 组件可以识别这些自定义组件，并在 submit 事件中返回组件的字段名及其对应字段值。")]),t._v(" "),a("p",[t._v("详细用法以及代码示例可见："),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/form",target:"_blank",rel:"noopener noreferrer"}},[t._v("form 组件参考文档"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"wx-form-field-group"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wx-form-field-group"}},[t._v("#")]),t._v(" wx://form-field-group")]),t._v(" "),a("p",[t._v("从基础库版本 "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("2.10.2"),a("OutboundLink")],1),t._v(" 开始提供支持。")]),t._v(" "),a("p",[t._v("使 form 组件可以识别到这个自定义组件内部的所有表单控件。")]),t._v(" "),a("p",[t._v("详细用法以及代码示例可见："),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/form",target:"_blank",rel:"noopener noreferrer"}},[t._v("form 组件参考文档"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"wx-form-field-button"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wx-form-field-button"}},[t._v("#")]),t._v(" wx://form-field-button")]),t._v(" "),a("p",[t._v("从基础库版本 "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("2.10.3"),a("OutboundLink")],1),t._v(" 开始提供支持。")]),t._v(" "),a("p",[t._v("使 form 组件可以识别到这个自定义组件内部的 button 。如果自定义组件内部有设置了 form-type 的 button ，它将被组件外的 form 接受。")]),t._v(" "),a("p",[t._v("详细用法以及代码示例可见："),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/form",target:"_blank",rel:"noopener noreferrer"}},[t._v("form 组件参考文档"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"wx-component-export"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wx-component-export"}},[t._v("#")]),t._v(" wx://component-export")]),t._v(" "),a("p",[t._v("从基础库版本 "),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("2.2.3"),a("OutboundLink")],1),t._v(" 开始提供支持。")]),t._v(" "),a("p",[t._v("使自定义组件支持 "),a("code",[t._v("export")]),t._v(" 定义段。这个定义段可以用于指定组件被 "),a("code",[t._v("selectComponent")]),t._v(" 调用时的返回值。")]),t._v(" "),a("p",[t._v("详细用法以及代码示例可见："),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/events",target:"_blank",rel:"noopener noreferrer"}},[t._v("selectComponent 参考文档"),a("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=r.exports}}]);